import{I as W,l as S,L as A,u as G,_ as X,G as Y}from"./array.14c25a96.js";import{e as j}from"./string.9e0c9fb8.js";import{t as D}from"./promise.aa1a7cc9.js";import{e1 as L,e2 as J,d as M,ds as Q,dt as ee,e3 as se,cV as F,t as C,r as O,cX as d,c_ as U,dh as p,l as o,cZ as t,D as y,dl as m,u as e,cY as w,dz as ae,dW as oe,dy as E,F as V,cW as te,di as re,d7 as le,e4 as ne,e5 as ue,e6 as de,e7 as ie}from"./vendor.58f5c150.js";import{F as N,B as ce,u as R,v as _,A as pe,w as me,b as B,I as x,M as we,m as $,L as fe,x as ve,y as ge,z as ye}from"./ant-design-vue.65af69df.js";import"./main.0866aa65.js";import"./lodash.52f79bb2.js";import"./node-forge.5968f396.js";import"./echarts.bae9122d.js";import"./prettier.bc782120.js";const _e={cn:{exit:"\u9000\u51FA\u767B\u5F55",password:"\u5BC6\u7801",back:"\u8FD4\u56DE\u7BA1\u7406\u9875",dialog:{modify:"\u4FEE\u6539@:password",old:"\u539F@:password",new:"\u65B0@:password",confirm:"\u786E\u8BA4@:password"},validator:{empty:"@:password\u4E0D\u80FD\u4E3A\u7A7A\u3002",length:"@:password\u9700\u4EE5\u5B57\u6BCD\u5F00\u5934\uFF0C\u957F\u5EA6\u57286~18\u4E4B\u95F4\u3002",consistent:"\u4E24\u6B21\u8F93\u5165\u4E0D\u4E00\u81F4\u3002"},message:{success:{edit:"\u4FEE\u6539\u6210\u529F",logout:"\u5DF2@:exit"}}},en:{exit:"Exit Login",password:"Password",back:"Back",dialog:{modify:"Modify @:password",old:"Old",new:"New",confirm:"Confirm"},validator:{empty:"@:password is empty.",length:"@:password should start with alphabet, length should be in 6 to 18.",consistent:"Passwords are inconsistent."},message:{success:{edit:"Success",exit:"@:exit Success"}}}},ke={cn:{page:"\u9875\u9762\u7BA1\u7406",masterplate:"\u6A21\u7248\u7BA1\u7406"},en:{page:"Page Manage",masterplate:"Masterplate Manage"}},be="user",Pe=i=>W(`${be}/changePassword`,i),he=[{key:"page",icon:L},{key:"masterplate",icon:J}];const Fe={class:"header-right"},Ce={class:"exit-dropdown"},Ee={class:"header-right_span"},Be=M({setup(i){const f=S.get(A.USER_INFO),u=f?Q.parse(f):{},k=ee(),b=se(),n=G(),{locale:v}=F({useScope:"global"}),{t:a}=F({useScope:"local",messages:_e}),g=C(!1);function K(){v.value=v.value==="en"?"cn":"en"}const l=O({password:"",newPassword:"",confirmPassword:""}),P=async(c,s)=>s?/^[a-zA-Z]\w{5,17}$/.test(s)?Promise.resolve():Promise.reject(a("validator.length")):Promise.reject(a("validator.empty")),T=O({password:[{required:!0,validator:P,trigger:"blur"}],newPassword:[{required:!0,validator:P,trigger:"blur"}],confirmPassword:[{required:!0,validator:async(c,s)=>{const[r]=await D(P(c,s));return r?Promise.reject(r):s!==l.newPassword?Promise.reject(a("validator.consistent")):Promise.resolve()},trigger:"blur"}]}),{resetFields:q,validate:z,validateInfos:h}=N.useForm(l,T),Z=async()=>{const[c]=await D(z());if(c)return;const s=j(l.password),r=j(l.newPassword),I=await Pe({password:s,newPassword:r});I.code===0?(g.value=!1,$.success(a("message.success.edit"))):$.error(I.msg)},H=()=>{S.remove(A.AUTHORIZATION),k.push(`/login?redirect=${b.path}`),$.success(a("message.success.logout"))};return(c,s)=>(d(),U(V,null,[p("div",Fe,[o(e(ce),{onClick:s[0]||(s[0]=r=>K())},{default:t(()=>[y(m(e(v)==="cn"?"English":"\u4E2D\u6587"),1)]),_:1}),o(e(me),null,{overlay:t(()=>[o(e(R),null,{default:t(()=>[o(e(_),{key:"0",onClick:s[1]||(s[1]=r=>g.value=!0)},{default:t(()=>[y(m(e(a)("dialog.modify")),1)]),_:1}),c.$route.path.includes("editor")?(d(),w(e(_),{key:"1",onClick:s[2]||(s[2]=r=>c.$router.push("/"))},{default:t(()=>[y(m(e(a)("back")),1)]),_:1})):ae("",!0),o(e(_),{key:"2",onClick:H},{default:t(()=>[y(m(e(a)("exit")),1)]),_:1})]),_:1})]),default:t(()=>[p("div",Ce,[o(e(pe),null,{icon:t(()=>[o(e(L))]),_:1}),p("span",Ee,m(e(u).name),1)])]),_:1}),o(e(oe),{class:"theme-change",onClick:s[3]||(s[3]=r=>e(n).switchTheme())})]),o(e(we),{visible:g.value,"onUpdate:visible":s[7]||(s[7]=r=>g.value=r),title:e(a)("dialog.modify"),"after-close":e(q),onOk:Z},{default:t(()=>[o(e(N),{model:e(l),"label-col":{span:4},"wrapper-col":{span:16}},{default:t(()=>[o(e(B),E({label:e(a)("dialog.old")},e(h).password),{default:t(()=>[o(e(x),{value:e(l).password,"onUpdate:value":s[4]||(s[4]=r=>e(l).password=r),type:"password"},null,8,["value"])]),_:1},16,["label"]),o(e(B),E({label:e(a)("dialog.new")},e(h).newPassword),{default:t(()=>[o(e(x),{value:e(l).newPassword,"onUpdate:value":s[5]||(s[5]=r=>e(l).newPassword=r),type:"password"},null,8,["value"])]),_:1},16,["label"]),o(e(B),E({label:e(a)("dialog.confirm")},e(h).confirmPassword),{default:t(()=>[o(e(x),{value:e(l).confirmPassword,"onUpdate:value":s[6]||(s[6]=r=>e(l).confirmPassword=r),type:"password"},null,8,["value"])]),_:1},16,["label"])]),_:1},8,["model"])]),_:1},8,["visible","title","after-close"])],64))}});const xe=i=>(de("data-v-02b8afc7"),i=i(),ie(),i),$e=xe(()=>p("div",{class:"logo"},[p("img",{width:"40",height:"40",src:Y})],-1)),Ie={class:"main"},Se=M({setup(i){const f=C(["page"]),u=C(!1),{t:k}=F({useScope:"local",messages:ke});return(b,n)=>{const v=te("RouterView");return d(),w(e(fe),{class:"container"},{default:t(()=>[o(e(ve),{collapsed:u.value,"onUpdate:collapsed":n[1]||(n[1]=a=>u.value=a),trigger:null,collapsible:""},{default:t(()=>[$e,o(e(R),{selectedKeys:f.value,"onUpdate:selectedKeys":n[0]||(n[0]=a=>f.value=a),theme:"dark",mode:"inline"},{default:t(()=>[(d(!0),U(V,null,re(e(he),a=>(d(),w(e(_),{key:a.key,onClick:g=>b.$router.push({name:a.key})},{default:t(()=>[(d(),w(le(a.icon))),p("span",null,m(e(k)(a.key)),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["selectedKeys"])]),_:1},8,["collapsed"]),p("div",Ie,[o(e(ge),{class:"layout-header"},{default:t(()=>[u.value?(d(),w(e(ne),{key:0,class:"trigger",onClick:n[2]||(n[2]=a=>u.value=!u.value)})):(d(),w(e(ue),{key:1,class:"trigger",onClick:n[3]||(n[3]=a=>u.value=!u.value)})),o(Be)]),_:1}),o(e(ye),{class:"layout-content"},{default:t(()=>[o(v)]),_:1})])]),_:1})}}});var Te=X(Se,[["__scopeId","data-v-02b8afc7"]]);export{Te as default};
