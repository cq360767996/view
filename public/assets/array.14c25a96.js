var et=Object.defineProperty,tt=Object.defineProperties;var nt=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var we=(e,t,n)=>t in e?et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,B=(e,t)=>{for(var n in t||(t={}))_e.call(t,n)&&we(e,n,t[n]);if(ne)for(var n of ne(t))Ce.call(t,n)&&we(e,n,t[n]);return e},I=(e,t)=>tt(e,nt(t));var ce=(e,t)=>{var n={};for(var a in e)_e.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&ne)for(var a of ne(e))t.indexOf(a)<0&&Ce.call(e,a)&&(n[a]=e[a]);return n};import{d4 as at,d5 as re,d as ae,P as ue,k as de,o as W,cX as P,cY as he,d6 as ke,d7 as Ie,cV as Oe,r as $,d8 as Re,d9 as Se,da as xe,db as Le,dc as Pe,dd as Te,de as pe,a5 as fe,df as ut,dg as ot,c_ as V,dh as Me,F as me,di as Ue,u as oe,dj as st,N as Ye,dk as lt,dl as it,t as ge,x as Fe,y as Xe,q as De,w as ct,l as m,dm as z,dn as rt,dp as $e,ae as dt,Y as ht,dq as j,dr as pt,ds as ze,Z as se,dt as ft,du as mt,dv as gt}from"./vendor.58f5c150.js";import{k as Ee,l as T}from"./lodash.52f79bb2.js";import{T as je,E as Ft,m as O}from"./ant-design-vue.65af69df.js";import"./node-forge.5968f396.js";import{g as Dt}from"./echarts.bae9122d.js";import"./prettier.bc782120.js";const Et=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))a(u);new MutationObserver(u=>{for(const o of u)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(u){const o={};return u.integrity&&(o.integrity=u.integrity),u.referrerpolicy&&(o.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?o.credentials="include":u.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(u){if(u.ep)return;u.ep=!0;const o=n(u);fetch(u.href,o)}};Et();const G=(e,t,n)=>{document.addEventListener(e,t,n)},Z=(e,t,n)=>{document.removeEventListener(e,t,n)},be=e=>{const t=["width","height","top","left","bottom","right","fontSize","borderWidth","borderRadius"],n={};for(const[a,u]of Object.entries(e))if(!!u){if(a==="rotate"){n.transform=`rotate(${u}deg)`;continue}if(a==="scale"){n.transform=`scale(${u/100})`;continue}n[a]=t.includes(a)?u+"px":u}return n},bt=(e,t=!0)=>{const h=e,{width:n,height:a,left:u,top:o}=h,s=ce(h,["width","height","left","top"]),c=t?{width:n,height:a,left:u,top:o}:B({},s);return be(c)},yt="modulepreload",Ge={},vt="/",He=function(t,n){return!n||n.length===0?t():Promise.all(n.map(a=>{if(a=`${vt}${a}`,a in Ge)return;Ge[a]=!0;const u=a.endsWith(".css"),o=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${o}`))return;const s=document.createElement("link");if(s.rel=u?"stylesheet":yt,u||(s.as="script",s.crossOrigin=""),s.href=a,document.head.appendChild(s),u)return new Promise((c,h)=>{s.addEventListener("load",c),s.addEventListener("error",h)})})).then(()=>t())};var Ne;(function(e){e.RADIO="radio",e.CHECKBOX="checkbox",e.INPUT="input",e.INPUT_NUMBER="input-number",e.SELECT="select",e.SWITCH="switch",e.SLIDER="slider",e.COLOR_PICKER="color-picker",e.BTN_GROUP="btn-group",e.TEXTAREA="textarea",e.CUSTOM="custom"})(Ne||(Ne={}));var H;(function(e){e.USER_INFO="user-info",e.AUTHORIZATION="authorization",e.IS_DARK="is-dark"})(H||(H={}));var C;(function(e){e.X="x",e.Y="y"})(C||(C={}));const At={cn:{top:"\u7F6E\u9876",bottom:"\u7F6E\u5E95",up:"\u4E0A\u79FB",down:"\u4E0B\u79FB",group:"\u6210\u7EC4",cancelGroup:"\u53D6\u6D88\u6210\u7EC4",lock:"\u9501\u5B9A",hide:"\u9690\u85CF",layer:"\u56FE\u5C42",tip:"\u5C1A\u672A\u6DFB\u52A0\u4EFB\u4F55\u7EC4\u4EF6"},en:{top:"Top",bottom:"Bottom",up:"Up",down:"Down",group:"Group",cancelGroup:"Cancel Group",lock:"Lock",hide:"Hide",layer:"Layer",tip:"There is No Component"}},Bt={cn:{top:"\u7F6E\u9876",bottom:"\u7F6E\u5E95",up:"\u4E0A\u79FB\u4E00\u5C42",down:"\u4E0B\u79FB\u4E00\u5C42",group:"\u6210\u7EC4",cancelGroup:"\u53D6\u6D88\u6210\u7EC4",lock:"\u9501\u5B9A",hide:"\u9690\u85CF",copy:"\u590D\u5236",delete:"\u5220\u9664"},en:{top:"Top",bottom:"Bottom",up:"Up",down:"Down",group:"Group",cancelGroup:"Cancel Group",lock:"Lock",hide:"Hide",copy:"Copy",delete:"Delete"}};const _t=e=>{const t=[{title:"\u5F3A\u8C03",data:[{name:"bounce",label:"\u5F39\u8DF3"},{name:"flash",label:"\u95EA\u70C1"},{name:"pulse",label:"\u653E\u5927\u7F29\u5C0F"},{name:"rubberBand",label:"\u653E\u5927\u7F29\u5C0F\u5F39\u7C27"},{name:"shakeX",label:"\u5DE6\u53F3\u6643\u52A8"},{name:"shakeY",label:"\u4E0A\u4E0B\u6643\u52A8"},{name:"headShake",label:"\u5DE6\u53F3\u5C0F\u5E45\u6643\u52A8"},{name:"swing",label:"\u5DE6\u53F3\u6247\u5F62\u6447\u6446"},{name:"tada",label:"\u653E\u5927\u6643\u52A8\u7F29\u5C0F"},{name:"wobble",label:"\u5C0F\u5E45\u6247\u5F62\u6447\u6446"},{name:"jello",label:"\u679C\u51BB\u6447\u6643"},{name:"heartBeat",label:"Y\u8F74\u65CB\u8F6C"}]},{title:"\u5EF6\u8FDF",data:[{name:"backInDown",label:"\u5EF6\u8FDF\u4E0A\u65B9\u8FDB\u5165"},{name:"backInLeft",label:"\u5EF6\u8FDF\u5DE6\u4FA7\u8FDB\u5165"},{name:"backInRight",label:"\u5EF6\u8FDF\u53F3\u4FA7\u8FDB\u5165"},{name:"backInUp",label:"\u5EF6\u8FDF\u4E0B\u65B9\u8FDB\u5165"},{name:"backOutDown",label:"\u5EF6\u8FDF\u4E0B\u65B9\u9000\u51FA"},{name:"backOutLeft",label:"\u5EF6\u8FDF\u5DE6\u4FA7\u9000\u51FA"},{name:"backOutRight",label:"\u5EF6\u8FDF\u53F3\u4FA7\u9000\u51FA"},{name:"backOutUp",label:"\u5EF6\u8FDF\u4E0A\u65B9\u9000\u51FA"}]},{title:"\u8DF3\u8DC3",data:[{name:"bounceIn",label:"\u8DF3\u8DC3\u8FDB\u5165"},{name:"bounceInDown",label:"\u4E0A\u65B9\u8DF3\u8DC3\u8FDB\u5165"},{name:"bounceInLeft",label:"\u5DE6\u4FA7\u8DF3\u8DC3\u8FDB\u5165"},{name:"bounceInRight",label:"\u53F3\u4FA7\u8DF3\u8DC3\u8FDB\u5165"},{name:"bounceInUp",label:"\u4E0B\u65B9\u8DF3\u8DC3\u8FDB\u5165"},{name:"bounceOut",label:"\u8DF3\u8DC3\u9000\u51FA"},{name:"bounceOutDown",label:"\u4E0B\u65B9\u8DF3\u8DC3\u9000\u51FA"},{name:"bounceOutLeft",label:"\u5DE6\u4FA7\u8DF3\u8DC3\u9000\u51FA"},{name:"bounceOutRight",label:"\u53F3\u4FA7\u8DF3\u8DC3\u9000\u51FA"},{name:"bounceOutUp",label:"\u4E0A\u65B9\u8DF3\u8DC3\u9000\u51FA"}]},{title:"\u6DE1\u5165/\u6DE1\u51FA",data:[{name:"fadeIn",label:"\u6DE1\u5165"},{name:"fadeInDown",label:"\u4E0A\u65B9\u6DE1\u5165"},{name:"fadeInDownBig",label:"\u4E0A\u65B9\u8FDC\u8DDD\u79BB\u6DE1\u5165"},{name:"fadeInLeft",label:"\u5DE6\u4FA7\u6DE1\u5165"},{name:"fadeInLeftBig",label:"\u5DE6\u4FA7\u8FDC\u8DDD\u79BB\u6DE1\u5165"},{name:"fadeInRight",label:"\u53F3\u4FA7\u6DE1\u5165"},{name:"fadeInRightBig",label:"\u53F3\u4FA7\u8FDC\u8DDD\u79BB\u6DE1\u5165"},{name:"fadeInUp",label:"\u4E0A\u65B9\u6DE1\u5165"},{name:"fadeInUpBig",label:"\u4E0A\u65B9\u8FDC\u8DDD\u79BB\u6DE1\u5165"},{name:"fadeInTopLeft",label:"\u5DE6\u4E0A\u6DE1\u5165"},{name:"fadeInTopRight",label:"\u53F3\u4E0A\u6DE1\u5165"},{name:"fadeInBottomLeft",label:"\u5DE6\u4E0B\u6DE1\u5165"},{name:"fadeInBottomRight",label:"\u53F3\u4E0B\u6DE1\u5165"},{name:"fadeOut",label:"\u6DE1\u51FA"},{name:"fadeOutDown",label:"\u4E0B\u65B9\u6DE1\u51FA"},{name:"fadeOutDownBig",label:"\u4E0B\u65B9\u8FDC\u8DDD\u79BB\u6DE1\u51FA"},{name:"fadeOutLeft",label:"\u5DE6\u4FA7\u6DE1\u51FA"},{name:"fadeOutLeftBig",label:"\u5DE6\u4FA7\u8FDC\u8DDD\u79BB\u6DE1\u51FA"},{name:"fadeOutRight",label:"\u53F3\u4FA7\u6DE1\u51FA"},{name:"fadeOutRightBig",label:"\u53F3\u4FA7\u8FDC\u8DDD\u79BB\u6DE1\u51FA"},{name:"fadeOutUp",label:"\u4E0A\u65B9\u6DE1\u51FA"},{name:"fadeOutUpBig",label:"\u4E0A\u65B9\u8FDC\u8DDD\u79BB\u6DE1\u51FA"},{name:"fadeOutTopLeft",label:"\u5DE6\u4E0A\u6DE1\u51FA"},{name:"fadeOutTopRight",label:"\u53F3\u4E0A\u6DE1\u51FA"},{name:"fadeOutBottomRight",label:"\u5DE6\u4E0B\u6DE1\u51FA"},{name:"fadeOutBottomLeft",label:"\u53F3\u4E0B\u6DE1\u51FA"}]},{title:"\u7FFB\u8F6C",data:[{name:"flip",label:"\u7FFB\u8F6C"},{name:"flipInX",label:"\u6A2A\u5411\u7FFB\u8F6C\u8FDB\u5165"},{name:"flipInY",label:"\u7EB5\u5411\u7FFB\u8F6C\u8FDB\u5165"},{name:"flipOutX",label:"\u6A2A\u5411\u7FFB\u8F6C\u9000\u51FA"},{name:"flipOutY",label:"\u7EB5\u5411\u7FFB\u8F6C\u9000\u51FA"}]},{title:"\u5149\u901F",data:[{name:"lightSpeedInRight",label:"\u53F3\u4FA7\u5149\u901F\u8FDB\u5165"},{name:"lightSpeedInLeft",label:"\u5DE6\u4FA7\u5149\u901F\u8FDB\u5165"},{name:"lightSpeedOutRight",label:"\u53F3\u4FA7\u5149\u901F\u9000\u51FA"},{name:"lightSpeedOutLeft",label:"\u5DE6\u4FA7\u5149\u901F\u9000\u51FA"}]},{title:"\u65CB\u8F6C",data:[{name:"rotateIn",label:"\u65CB\u8F6C\u8FDB\u5165"},{name:"rotateInDownLeft",label:"\u5DE6\u4E0A\u65CB\u8F6C\u8FDB\u5165"},{name:"rotateInDownRight",label:"\u53F3\u4E0A\u65CB\u8F6C\u8FDB\u5165"},{name:"rotateInUpLeft",label:"\u53F3\u4E0B\u65CB\u8F6C\u8FDB\u5165"},{name:"rotateInUpRight",label:"\u5DE6\u4E0B\u65CB\u8F6C\u8FDB\u5165"},{name:"rotateOut",label:"\u65CB\u8F6C\u9000\u51FA"},{name:"rotateOutDownLeft",label:"\u5DE6\u4E0B\u65CB\u8F6C\u9000\u51FA"},{name:"rotateOutDownRight",label:"\u53F3\u4E0B\u65CB\u8F6C\u9000\u51FA"},{name:"rotateOutUpLeft",label:"\u5DE6\u4E0A\u65CB\u8F6C\u9000\u51FA"},{name:"rotateOutUpRight",label:"\u53F3\u4E0A\u65CB\u8F6C\u9000\u51FA"}]},{title:"\u653E\u7F29",data:[{name:"zoomIn",label:"\u653E\u7F29\u8FDB\u5165"},{name:"zoomInDown",label:"\u4E0A\u65B9\u653E\u7F29\u8FDB\u5165"},{name:"zoomInLeft",label:"\u5DE6\u4FA7\u653E\u7F29\u8FDB\u5165"},{name:"zoomInRight",label:"\u53F3\u4FA7\u653E\u7F29\u8FDB\u5165"},{name:"zoomInUp",label:"\u4E0B\u65B9\u653E\u7F29\u8FDB\u5165"},{name:"zoomOut",label:"\u653E\u7F29\u9000\u51FA"},{name:"zoomOutDown",label:"\u4E0B\u65B9\u653E\u7F29\u9000\u51FA"},{name:"zoomOutLeft",label:"\u5DE6\u4FA7\u653E\u7F29\u9000\u51FA"},{name:"zoomOutRight",label:"\u53F3\u4FA7\u653E\u7F29\u9000\u51FA"},{name:"zoomOutUp",label:"\u4E0A\u65B9\u653E\u7F29\u9000\u51FA"}]},{title:"\u6ED1\u52A8",data:[{name:"slideInDown",label:"\u4E0A\u65B9\u6ED1\u5165"},{name:"slideInLeft",label:"\u5DE6\u4FA7\u6ED1\u5165"},{name:"slideInRight",label:"\u53F3\u4FA7\u6ED1\u5165"},{name:"slideInUp",label:"\u4E0B\u65B9\u6ED1\u5165"},{name:"slideOutDown",label:"\u4E0B\u65B9\u6ED1\u51FA"},{name:"slideOutLeft",label:"\u5DE6\u4FA7\u6ED1\u51FA"},{name:"slideOutRight",label:"\u53F3\u4FA7\u6ED1\u51FA"},{name:"slideOutUp",label:"\u4E0A\u65B9\u6ED1\u51FA"}]},{title:"\u7279\u6B8A",data:[{name:"hinge",label:"\u60AC\u6302\u6389\u843D"},{name:"jackInTheBox",label:"\u4E0B\u65B9\u98DE\u5165"},{name:"rollIn",label:"\u98DE\u5165"},{name:"rollOut",label:"\u98DE\u51FA"}]}],n=at({show:!1,selected:t[0].title,data:t,curAnimation:""}),a=d=>d===n.curAnimation?` animate__animated animate__${d}`:"",u=d=>{n.curAnimation=d},o=()=>{n.curAnimation=""},s=d=>{e.animations||(e.animations=[]);const{animations:i}=e;i.push(I(B({id:re()},d),{animationDelay:0,animationDuration:1,animationIterationCount:1,repeat:!1})),n.show=!1},c=async(d,i)=>new Promise(r=>{const{animations:p}=e;if(!(p==null?void 0:p[d]))return r();const{name:g,animationDelay:F,animationDuration:b,animationIterationCount:D}=p[d],v="animate__animated",A=`animate__${g}`;i.style.animationDelay=`${F}s`,i.style.animationDuration=`${b}s`,i.style.animationIterationCount=`${D}`,i.classList.add(v,A);const E=()=>{i.removeEventListener("animationend",E),i.removeEventListener("animationcancel",E),i.style.animationDelay="",i.style.animationDuration="",i.style.animationIterationCount="",i.classList.remove(v,A),r()};i.addEventListener("animationend",E),i.addEventListener("animationcancel",E)});return{drawer:n,handleMouseover:u,handleMouseleave:o,getAnimationClass:a,addAnimation:s,playAll:async d=>{if(!!d&&e.animations)for(let i=0;i<t.length;i++)await c(i,d)},play:c}};var Ke=(e,t)=>{for(const[n,a]of t)e[n]=a;return e};const Ct=ae({props:{data:{type:Object,default:()=>({})},patchAll:{type:Boolean,default:!1},editorMode:{type:Boolean,default:!1}},setup(e){const t=ue(),n=de(()=>e.data);return W(()=>{var o;const{animations:a}=n.value;if(e.editorMode||!a||!((o=t.value)==null?void 0:o.$el))return;const{playAll:u}=_t(n.value);u(t.value.$el)}),{splitStyleAndPatch:bt,patchUnit:be,box:t}}});function wt(e,t,n,a,u,o){return P(),he(Ie(`cq-${e.data.component}`),{ref:"box",group:e.data.group,data:e.data.data,"props-data":e.data.propsData,style:ke(e.patchAll?e.patchUnit(e.data.style):e.splitStyleAndPatch(e.data.style,!1))},null,8,["group","data","props-data","style"])}var kt=Ke(Ct,[["render",wt]]);const It=["onClick"],Ot=ae({props:{menuType:{type:String,default:()=>"board"},container:Object},setup(e){const t=e,n=w(),a=Ve(),{t:u}=Oe({useScope:"local",messages:Bt}),o=ue(),s=$([{name:u("top"),icon:Re,event:()=>n.moveUp(!0)},{name:u("bottom"),icon:Se,event:()=>n.moveDown(!0)},{name:u("up"),icon:xe,event:()=>n.moveUp()},{name:u("down"),icon:Le,event:()=>n.moveDown()},{name:u("group"),icon:Pe,disable:!1,event:()=>n.group()},{name:u("cancelGroup"),icon:Te,disable:!1,event:()=>n.cancelGroup()},{name:u("lock"),icon:pe,disable:!1,event:()=>n.toggleLocked(n.selected)},{name:u("hide"),icon:fe,disable:!1,event:()=>n.hide(n.selected)},{name:u("copy"),icon:ut,event:()=>n.copy()},{name:u("delete"),icon:ot,event:()=>n.del()}]),c=(d,i,r)=>{if(d.stopPropagation(),i){d.preventDefault();return}a.hide(t.menuType),r()},h=()=>{G("click",d=>{d.stopPropagation(),d.preventDefault(),a.hideAll()})};return W(()=>{s[4].disable=Je(n),s[5].disable=Qe(n),a.setRefAndContainer(t.menuType,o.value,t.container),h()}),(d,i)=>(P(),V("div",{ref:(r,p)=>{p.menuRef=r,st(o)&&(o.value=r)},class:"board-menu",style:ke(oe(be)(oe(a)[e.menuType].style)),onMousedown:i[0]||(i[0]=Ye(()=>{},["stop"])),onMouseup:i[1]||(i[1]=Ye(()=>{},["stop"]))},[Me("ul",null,[(P(!0),V(me,null,Ue(oe(s),r=>(P(),V("li",{key:r.name,class:lt({"--disable":r.disable}),onClick:p=>c(p,r.disable,r.event)},[(P(),he(Ie(r.icon))),Me("span",null,it(r.name),1)],10,It))),128))])],36))}});const tn=()=>{const e=w(),t=$({show:!1,style:{width:0,height:0,top:0,left:0}});return{selectMask:t,handleMousedown:a=>{if(a.buttons===1){t.show=!0;const{pageX:u,pageY:o}=a,s=Kt(u,o);if(!s)return;t.style=I(B(B({},t.style),s),{width:0,height:0});const c=d=>{const{pageX:i,pageY:r}=d,p=M(i-u),g=M(r-o);p<0&&(t.style.left=s.left+p),g<0&&(t.style.top=s.top+g),t.style.width=Math.abs(p),t.style.height=Math.abs(g),e.calcSelectedByRect(t.style)},h=d=>{d.stopPropagation(),Z("mousemove",c),Z("mouseup",h),t.show=!1,d.clientX==u&&d.clientY==o&&e.cancelSelected()};G("mousemove",c),G("mouseup",h)}}}},Rt=()=>{const e=n=>{const u=w().refs[n];if(u){const o=Dt(u);o==null||o.resize()}};return{handleEchartsResize:e,handleAllEchartsResize:n=>{for(let a=0,u=n.data.length;a<u;a++)e(a)}}},nn=(e,t,n)=>{const a=ue(),u=$({width:0,height:0,top:0,left:0}),o=ge(!0),s=K(),c=Be(),h=()=>{if(!e.value||!t.value||!a.value)return;const{width:b,height:D}=e.value.getBoundingClientRect(),{width:v,height:A}=t.value.getBoundingClientRect(),{width:E,height:l}=a.value.getBoundingClientRect(),f=v/b,y=A/D;u.width=Math.min(f*E,E),u.height=Math.min(y*l,l),n.value++},d=b=>{if(b.buttons!==1||!a.value)return;const D=b.target;let v=b.clientX,A=b.clientY,{left:E,top:l}=u;const{width:f,height:y}=a.value.getBoundingClientRect(),{width:X,height:q}=D.getBoundingClientRect(),U=f-X,R=y-q,S=k=>{if(k.stopPropagation(),!t.value||!e.value)return;const{clientX:_,clientY:Y}=k,L=_-v,ie=Y-A;let ee=0,te=0;L<0&&u.left<=0?(v=_,E=0,ee=0):L>=0&&u.left>=U?(v=_,E=U,ee=U):ee=E+L,ie<0&&u.top<=0?(A=Y,l=0,te=0):ie>=0&&u.top>=R?(A=Y,l=R,te=R):te=l+ie,u.left=ee,u.top=te},x=k=>{k.stopPropagation(),Z("mousemove",S),Z("mouseup",x)};G("mousemove",S),G("mouseup",x)},i=()=>{if(!e.value||!t.value||!a.value)return;const b=K(),D=a.value.getContext("2d");if(!D)return;const{width:v,height:A}=a.value;D.clearRect(0,0,v,A);const{width:E,height:l}=a.value.getBoundingClientRect(),{width:f,height:y}=e.value.getBoundingClientRect(),{width:X,height:q}=b.config,U=E/M(f),R=l/M(y),S=U*2,x=R*2,k=X*S,_=q*x,Y=60*S,L=60*x;D.strokeStyle="#1890ff",D.lineWidth=2,D.strokeRect(Y,L,k,_)},r=Ee(h,100),p=Ee(i,100),g=()=>{if(!e.value||!t.value||!a.value)return;const{width:b,height:D}=e.value.getBoundingClientRect(),{width:v,height:A}=a.value.getBoundingClientRect(),{scrollLeft:E,scrollTop:l}=t.value;u.left=E/b*v,u.top=l/D*A};return W(()=>{window.addEventListener("resize",r),window.addEventListener("resize",p),Fe(()=>{h(),i()})}),Xe(()=>{window.removeEventListener("resize",r),window.removeEventListener("resize",p)}),De(()=>{if(!t.value||!a.value||!e.value)return;const{width:b,height:D}=e.value.getBoundingClientRect(),{width:v,height:A}=a.value.getBoundingClientRect(),E=u.left*b/v,l=u.top*D/A;t.value.scroll(E,l)}),ct(c,()=>{setTimeout(()=>{h(),i()},300)}),De(()=>{s.config.scale&&(r(),p())}),{viewportSize:u,resizeViewport:h,thumbnailRef:a,handleThumbnailMousedown:d,syncScroll:g,showThumbnail:o,switchThumbnail:()=>{o.value=!o.value}}},an=e=>{const t=K(),n=$({width:0,height:0}),a=ge(0),u=c=>c+"%",o=()=>{if(!e.value)return;const{width:c,height:h}=e.value.getBoundingClientRect(),{width:d,height:i}=t.config,r=M(d+400,!0),p=M(i+400,!0),g=c-4,F=h-4;n.width=r<=g?g:r,n.height=p<=F?F:p,a.value++},s=Ee(o,100);return W(()=>{De(()=>{t.config.scale&&o()})}),{sliderFormatter:u,handleSliderChange:s,screenShotSize:n,rulerKey:a}},un=()=>{const e=$([{direction:C.X,marklineDct:C.Y,marklines:[]},{direction:C.Y,marklineDct:C.X,marklines:[]}]);return{rulerData:e,getStyle:(o,s)=>{const c=o===C.Y?" rotate(90deg)":"",h=o===C.Y?"top":"left";return`transform:${c} translateX(${s[h]}px)`},getUnit:o=>o===C.X?"width":"height",addMarkline:(o,s)=>{const{clientX:c,clientY:h}=o,d=o.target,{left:i,top:r}=d.getBoundingClientRect(),[p,g]=s===C.X?[h-r,1]:[c-i,0];e[g].marklines.push(p)},cancelMarkline:(o,s)=>{const c=s===C.X?0:1;e[c].marklines.splice(o,1)}}},on=()=>{const e=K(),t=Be(),n=w(),a={Backspace:()=>n.del(),a:o=>o&&n.selectAll(),s:o=>o&&e.savePage(),c:o=>o&&n.copy(),ArrowLeft:o=>{o?t.switchPanelShow("layer"):n.selected.forEach(s=>{n.data[s].style.left-=e.config.gap})},ArrowUp:o=>{o?t.switchPanelShow("component"):n.selected.forEach(s=>{n.data[s].style.top-=e.config.gap})},ArrowRight:o=>{o?t.switchPanelShow("config"):n.selected.forEach(s=>{n.data[s].style.left+=e.config.gap})},ArrowDown:()=>{n.selected.forEach(o=>{n.data[o].style.top+=e.config.gap})}},u=o=>{var c;if(!((c=document.querySelector(".canvas-wrapper"))==null?void 0:c.contains(document.activeElement)))return;const s=a[o.key];if(s){o.preventDefault(),o.stopPropagation();const h=o.ctrlKey||o.metaKey;s(h)}};W(()=>G("keydown",u)),Xe(()=>Z("keydown",u))};var St="/assets/logo.8407279e.svg";var sn=ae({name:"layer-panel",setup(){const e=w(),t=Be(),n=Ve(),a=ge(!1),u=ue(),{t:o}=Oe({useScope:"local",messages:At}),s=[{tip:o("top"),icon:Re,event:()=>e.moveUp(!0)},{tip:o("bottom"),icon:Se,event:()=>e.moveDown(!0)},{tip:o("up"),icon:xe,event:()=>e.moveUp()},{tip:o("down"),icon:Le,event:()=>e.moveDown()}],c=[{tip:o("group"),icon:Pe,event:()=>e.group()},{tip:o("cancelGroup"),icon:Te,event:()=>e.cancelGroup()},{tip:o("lock"),icon:pe,event:()=>e.toggleLocked(e.selected)},{tip:o("hide"),icon:fe,event:()=>e.hide(e.selected)}],h=$({});e.data.forEach(l=>{var f;((f=l==null?void 0:l.group)==null?void 0:f.length)&&(h[l.id]=!1)});const d=de(()=>{const l=[];return l[0]={disable:Je(e)},l[1]={disable:Qe(e)},l[2]={disable:e.selected.length===0},l[3]={disable:e.selected.length===0},l}),i=de(()=>a.value?"--item":"--thumbail");function r(l,f){l.stopPropagation(),e.toggleLocked(f)}function p(l,f){l.stopPropagation(),e.show(f)}function g(l,f){l.ctrlKey||l.metaKey?e.changeSelected(f):e.setIndex(f)}function F(l){(l===0&&a.value||l===1&&!a.value)&&(a.value=!a.value)}function b(l){h[l]=!h[l]}function D(l,f){l.preventDefault(),e.selected.includes(f)||e.setIndex(f),n.show(l,Q.LAYER,e)}function v(){return s.map(l=>m(je,{key:l.icon.name,placement:"bottom",title:l.tip},{default:()=>[m(l.icon,{onClick:l.event,class:z({"--disable":e.selected.length===0})},null)]}))}function A(){return e.data.map((l,f)=>{const{group:y,id:X,locked:q}=l,{display:U}=l.style,R=a.value?m($e,null,null):m("img",{src:St},null);let S,x=R,k;if(q&&(k=m(pe,{class:"--icon",onClick:_=>r(_,f)},null)),U==="none"&&(k=m(fe,{class:"--icon",onClick:_=>p(_,f)},null)),y==null?void 0:y.length){const[_,Y]=h[X]?["rotate(90deg)","block"]:["rotate(0deg)","none"];x=m(ht,{class:"--animated",style:{transform:_},onClick:b.bind(null,X)},null),S=y.map(L=>m("li",{key:L.id,class:z("--animated",i.value),style:{display:Y}},[R,m("b",null,[L.label])]))}return m(me,null,[m("li",{key:l.id,class:z(i.value,{"--active":e.selected.includes(f)}),onContextmenu:_=>D(_,f),onMouseup:_=>g(_,f)},[k,x,m("b",null,[l.label])]),S])})}function E(){return c.map((l,f)=>{const y=d.value[f];return m(je,{key:l.icon.name,placement:"bottom",title:l.tip},{default:()=>[m(l.icon,{key:l.icon.name,onClick:(y==null?void 0:y.disable)?void 0:l.event,class:z({"--disable":y==null?void 0:y.disable})},null)]})})}return()=>m("div",{class:z("layer-panel",{"--hide":!t.layer}),ref:u},[m("header",{class:"layer-panel__header"},[m("div",null,[o("layer")]),m("section",null,[[rt,$e].map((l,f)=>m(l,{key:l.name,class:z({"--active":f===0?!a.value:a.value}),onClick:F.bind(null,f)},null)),m(dt,{onClick:()=>t.switchPanelShow("layer")},null)])]),m("section",{class:"layer-panel__wrapper"},[m("header",{class:"layer-panel__toolbar"},[v()]),e.data.length===0?m(Ft,{description:o("tip")},null):m("ul",{class:"layer-panel__box"},[A()]),n.layer.show&&m(Ot,{"menu-type":Q.LAYER,container:u.value},null)]),m("footer",{class:"layer-panel__footer"},[E()])])}});var ye={maxSnapshot:20,defaultComponentSize:{width:100,height:100},defaultPageSize:{width:1920,height:1080}};const ln={url:"\u63A5\u53E3\u6570\u636E",static:"\u9759\u6001\u6570\u636E"};const xt={class:"board-group"},Lt=ae({props:{group:{type:Array,default:()=>[]}},setup(e){return(t,n)=>(P(),V("div",xt,[(P(!0),V(me,null,Ue(e.group,a=>(P(),he(oe(kt),{key:a.id,data:a,"patch-all":""},null,8,["data"]))),128))]))}});var Pt=Ke(Lt,[["__scopeId","data-v-644c95db"]]);const Tt={"./basic/index.ts":()=>He(()=>import("./index.fb34feed.js"),["assets/index.fb34feed.js","assets/vendor.58f5c150.js","assets/vendor.7d8b91be.css","assets/lodash.52f79bb2.js","assets/ant-design-vue.65af69df.js","assets/ant-design-vue.1704afae.css","assets/node-forge.5968f396.js","assets/echarts.bae9122d.js","assets/prettier.bc782120.js"]),"./chart/index.ts":()=>He(()=>import("./index.619b4866.js"),["assets/index.619b4866.js","assets/vendor.58f5c150.js","assets/vendor.7d8b91be.css","assets/lodash.52f79bb2.js","assets/ant-design-vue.65af69df.js","assets/ant-design-vue.1704afae.css","assets/node-forge.5968f396.js","assets/echarts.bae9122d.js","assets/prettier.bc782120.js"])},ve={};for(const[e,t]of Object.entries(Tt)){const n=e.match(/\.\/(.*)\/index\.ts/);(n==null?void 0:n[1])&&(ve[n[1]]=t)}const Mt=[],qe=[];var cn=async e=>{const t=async n=>{const u=(await n()).default,{name:o,icon:s,components:c,order:h,dataConfig:d}=u,i=[];for(const[r,p]of Object.entries(c)){const F=(await p()).default;F.type=r,F.dataConfig=d||F.dataConfig,e.component(`cq-${r}`,F.component),i.push(F),qe.push(F)}Mt[h]={groupName:o,icon:s,list:i}};e.component("cq-group",Pt);for(const n in ve)await t(ve[n])};const Ut=e=>{const t=qe.find(n=>n.type===e);if(t)return T(t)},w=j("board",{state:()=>({selected:[],data:[],refs:[],offset:{left:0,top:0}}),getters:{curCom(e){return e.selected.length>0?e.data[e.selected[0]]:void 0},curComs(e){return e.selected.map(t=>e.data[t])}},actions:{rawAppend(e){const t=[],n=[];Array.isArray(e)?e.forEach((a,u)=>{t.push(a),n.push(this.data.length+u)}):(t.push(e),n.push(this.data.length)),this.data.push(...t),this.selected=n},append({top:e=0,left:t=0,type:n=""}){const a=Ut(n);if(!a)throw new Error("\u83B7\u53D6\u4E0D\u5230\u8BE5\u7EC4\u4EF6\u4FE1\u606F");const{style:u,data:o,propsData:s}=T(a),c=0,h=1,d=n,i=re(),r=B(B({top:e,left:t,rotate:c,opacity:h},ye.defaultComponentSize),u),p=a.name;this.rawAppend({id:i,component:d,label:p,propsData:s,style:r,data:o})},del(){this.selected.length>0&&(Ze(this.data,this.selected),this.selected=[],O.success("\u5220\u9664\u6210\u529F\uFF01"))},cancelSelected(){this.selected=[]},setIndex(e){const t=typeof e=="number"?[e]:e,n=[],{data:a}=this;t.forEach(u=>{!a[u].locked&&a[u].style.display!=="none"&&n.push(u)}),this.selected=n},spliceSelected(e){this.selected.splice(this.selected.indexOf(e),1)},appendSelected(e){const{data:t}=this,n=typeof e=="number"?[e]:e,a=[];n.forEach(u=>{!t[u].locked&&t[u].style.display!=="none"&&a.push(u)}),this.selected.push(...a)},changeSelected(e){this.selected.includes(e)?this.spliceSelected(e):this.appendSelected(e)},setBoard(e){e?Object.assign(this,e):(this.data=[],this.selected=[]),Fe(()=>{const{handleAllEchartsResize:t}=Rt();t(this)})},copy(){if(this.selected.length>0){const e=this.selected.map(t=>{const n=T(this.data[t]);return n.style.left+=10,n.style.top+=10,n});this.rawAppend(e)}},moveUp(e=!1){const{data:t,selected:n}=this,a=t.length;if(n.length!==0)if(n.length>1)O.error("\u591A\u9009\u65E0\u6CD5\u79FB\u52A8");else if(n[0]===a-1)O.error("\u5DF2\u7ECF\u662F\u6700\u9876\u5C42\uFF01");else{const u=e?a-1:n[0]+1;[t[n[0]],t[u]]=[t[u],t[n[0]]]}},moveDown(e=!1){const{data:t,selected:n}=this;if(n.length!==0)if(n.length>1)O.error("\u591A\u9009\u65E0\u6CD5\u79FB\u52A8");else if(n[0]===0)O.error("\u5DF2\u7ECF\u662F\u6700\u5E95\u5C42\uFF01");else{const a=e?0:n[0]-1;[t[n[0]],t[a]]=[t[a],t[n[0]]]}},calcSelectedByRect(e){this.cancelSelected();const t=[];this.data.forEach((n,a)=>{const{width:u,height:o,left:s,top:c}=n.style,h=Math.min(s,e.left),d=Math.min(c,e.top),i=Math.max(s+u,e.left+e.width),r=Math.max(c+o,e.top+e.height),p=i-h,g=r-d;p<u+e.width&&g<o+e.height&&t.push(a)}),this.setIndex(t)},group(){const{selected:e,data:t}=this,n=Ze(t,e),a=n.reduce((r,p)=>{const{left:g,top:F,width:b,height:D}=p.style;return{leftX:Math.min(r.leftX,g),leftY:Math.min(r.leftY,F),rightX:Math.max(r.rightX,b+g),rightY:Math.max(r.rightY,D+F)}},{leftX:1/0,leftY:1/0,rightX:0,rightY:0}),{leftX:u,leftY:o,rightX:s,rightY:c}=a;n.forEach(r=>{r.style.top-=o,r.style.left-=u});const h=s-u,d=c-o,i={id:re(),component:"group",label:"\u6210\u7EC4",group:n,style:{top:o,left:u,width:h,height:d,rotate:0,opacity:1}};e.length=0,this.rawAppend(i)},cancelGroup(){const{selected:e,data:t}=this,n=t[e[0]];t.splice(e[0],1);const a=n.group;if(!a)return;const{left:u,top:o}=n.style,s=[];a.forEach(c=>{c.style.left+=u,c.style.top+=o,s.push(c)}),this.rawAppend(s)},toggleLocked(e){const{data:t,selected:n}=this;(typeof e=="number"?[e]:[...e]).forEach(u=>{const o=t[u],s=n.indexOf(u);o.locked=!o.locked,o.locked&&s>-1&&n.splice(s,1)})},hide(e){const{data:t,selected:n}=this;(typeof e=="number"?[e]:[...e]).forEach(u=>{t[u].style.display="none";const o=n.indexOf(u);o>-1&&n.splice(o,1)})},show(e){this.data[e].style.display="block"},selectAll(){const{data:e}=this;this.selected=e.map((t,n)=>n)},clearRefs(){this.refs.length=0},setOffset(e){this.offset=e},pushRef(e){this.refs.push(e)}}}),Yt="\u8FDE\u63A5\u51FA\u9519\u4E86~",Ae=e=>{const t=typeof e=="string"?e:Yt;return Promise.resolve({code:-1e4,msg:t})},Xt="/api/v1/",$t=e=>{const t={400:"\u8BF7\u6C42\u9519\u8BEF(400)",401:"\u672A\u6388\u6743\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55(401)",403:"\u62D2\u7EDD\u8BBF\u95EE(403)",404:"\u8BF7\u6C42\u51FA\u9519(404)",408:"\u8BF7\u6C42\u8D85\u65F6(408)",500:"\u670D\u52A1\u5668\u9519\u8BEF(500)",501:"\u670D\u52A1\u672A\u5B9E\u73B0(501)",502:"\u7F51\u7EDC\u9519\u8BEF(502)",503:"\u670D\u52A1\u4E0D\u53EF\u7528(503)",504:"\u7F51\u7EDC\u8D85\u65F6(504)",505:"HTTP\u7248\u672C\u4E0D\u53D7\u652F\u6301(505)",0:`\u8FDE\u63A5\u51FA\u9519(${e})!`};return`${t[e]||t[0]}\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01`},N=pt.create({baseURL:Xt,timeout:1e4,headers:{"Content-Type":"application/json"},transformResponse:[e=>(typeof e=="string"&&e.startsWith("{")&&(e=ze.parse(e)),e)]});N.interceptors.request.use(e=>{const t=le.get(H.AUTHORIZATION);return t&&e.headers&&(e.headers.authorization=t),e},Ae);N.interceptors.response.use(async e=>{const t=e.status;return t<200||t>=300?Ae($t(t)):e.data},Ae);const We=(e,t,n)=>N.get(e,I(B({},n),{params:t})),zt=(e,t,n)=>N.post(e,t,n),jt=(e,t,n)=>N.put(e,t,n),Gt=(e,t,n)=>N.delete(e,I(B({},n),{params:t})),J="page",Ht=e=>zt(J,e),rn=e=>Gt(`${J}/${e}`),Nt=e=>jt(J,e),dn=e=>We(`${J}/${e}`),hn=()=>We(J),K=j("page",{state(){const e=I(B({_id:"",__v:0},ye.defaultPageSize),{title:"",description:"",backgroundColor:"",scale:100,gap:1,url:"",zoom:0,author:"",pageMode:0});return{config:e,cache:I(B({},e),{components:[]})}},actions:{updateCache(){const e=w();Object.assign(this.cache,this.config),this.cache.components=T(se(e.data))},async savePage(){const e=w(),t=ft();if(e.data.length===0){O.error("\u5C1A\u672A\u6DFB\u52A0\u4EFB\u4F55\u7EC4\u4EF6\uFF01");return}const n=T(se(e.data)),a=B({components:n},this.config),s=a,{_id:u}=s,o=ce(s,["_id"]);if(u)(await Nt(se(a))).code===0&&(O.success("\u4FDD\u5B58\u6210\u529F\uFF01"),this.updateCache());else{const c=await Ht(B({},o));c.code===0&&(O.success("\u521B\u5EFA\u6210\u529F\uFF01"),this.config._id=c.data._id,this.updateCache(),t.push(`/editor/${c.data._id}`))}},isModified(){const e=w(),t=I(B({},this.config),{components:se(e.data)});return JSON.stringify(t)!==JSON.stringify(this.cache)}}}),pn=j("snapshot",{state:()=>({data:[],index:-1}),actions:{undo(){if(this.index>-1){this.index--;const e=this.index===-1?void 0:T(this.data[this.index]);if(e){const{selected:t,page:n}=e,{components:a}=n;w().setBoard({selected:t,data:a})}}},redo(){if(this.index<this.data.length-1){this.index++;const e=w(),t=T(this.data[this.index]),{selected:n,page:a}=t,{components:u}=a;e.setBoard({selected:n,data:u})}},rawRecordSnapshot(e,t){this.data[++this.index]={page:e,selected:t},this.index<this.data.length-1&&(this.data=this.data.slice(0,this.index+1)),this.data.length>ye.maxSnapshot&&this.data.shift(),O.success("\u4FDD\u5B58\u6210\u529F\uFF01")},recordSnapshot(){const e=K(),t=w(),{data:n,selected:a}=t,u=T(n),o=I(B({},e.config),{components:u});this.rawRecordSnapshot(o,a)}}}),fn=j("theme",{state(){return{value:"light"}},actions:{async changeTheme(e){this.value=e,e==="dark"?(gt||await mt(),le.set(H.IS_DARK,1)):le.remove(H.IS_DARK),document.documentElement.setAttribute("data-theme",this.value)},async switchTheme(){const e=le.get(H.IS_DARK);this.changeTheme(e?"light":"dark")}}}),Be=j("panel",{state(){return{layer:!0,component:!0,config:!0,util:!0}},actions:{switchPanelShow(e){this[e]=!this[e]}}});var Q;(function(e){e.BOARD="board",e.LAYER="layer"})(Q||(Q={}));const Ve=j("menu",{state(){return{board:{show:!1,style:{}},layer:{show:!1,style:{}}}},actions:{show(e,t,n){e.preventDefault();const{pageX:a,pageY:u}=e;n.selected.length!==0&&(this[t].show=!0,Fe(()=>{const{ref:o,container:s,style:c}=this[t];if(!o||!s)return;const h=10,{width:d,height:i}=o.getBoundingClientRect(),{width:r,height:p,left:g,top:F}=s.getBoundingClientRect();c.left=Math.min(a-g,r-d-h),c.top=Math.min(u-F,p-i-h)}))},hide(e){this[e].show=!1},hideAll(){Object.values(Q).forEach(e=>{this.hide(e)})},setRefAndContainer(e,t,n){this[e].ref=t,this[e].container=n}}});function M(e,t=!1){const a=K().config.scale/100,u=t?e*a:e/a;return Math.floor(u)}const Kt=(e,t,n=".board")=>{const a=document.querySelector(n);if(!a)return;const u=a.getBoundingClientRect();return{top:M(t-u.top),left:M(e-u.left)}},le={set(e,t,n=864e5){const a=typeof t=="string"?t:ze.stringify(t);return localStorage.setItem(e,a),localStorage.setItem(`${e}__expires__`,Date.now()+n+""),t},get(e){const t=Date.now(),n=localStorage.getItem(`${e}__expires__`)||t+1;if(t>=n){this.remove(e);return}return localStorage.getItem(e)},remove(e){localStorage.removeItem(e),localStorage.removeItem(`${e}__expires__`)}},mn=e=>e.map(t=>I(B({},t),{dataIndex:t.dataIndex||t.key,align:"center",slots:{customRender:t.key}})),Ze=(e,t)=>{const n=t.map(a=>e[a]);return n.forEach(a=>{const u=e.indexOf(a);e.splice(u,1)}),n},Je=e=>{const{selected:t,data:n}=e;if(t.length<=1)return!0;let a=0;return t.forEach(u=>{if(!n[u])return;const{group:o}=n[u];(!o||o.length===0)&&a++}),a!==t.length},Qe=e=>{const{selected:t,data:n}=e;if(t.length!==1)return!0;const{group:a}=n[t[0]];return!(a==null?void 0:a.length)};export{Ut as A,kt as B,pn as C,ln as D,dn as E,Ne as F,St as G,sn as H,zt as I,H as L,Q as M,Ke as _,He as a,cn as b,mn as c,rn as d,We as e,w as f,hn as g,K as h,Ve as i,Z as j,Rt as k,le as l,tn as m,an as n,G as o,be as p,nn as q,un as r,bt as s,on as t,fn as u,Ot as v,M as w,Be as x,Mt as y,_t as z};
