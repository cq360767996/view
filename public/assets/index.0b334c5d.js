import{I as H,l as A,L as $,u as z,_ as W,G as X}from"./array.bf0c4971.js";import{e as I}from"./string.fd2b806e.js";import{t as D}from"./promise.aa1a7cc9.js";import{e3 as L,e4 as Y,d as S,d7 as J,dt as Q,e5 as ee,t as C,j as x,r as U,cX as d,c_ as O,dj as p,l as t,cZ as a,D as w,dn as P,u as e,cY as m,dB as se,e2 as te,dA as B,F as V,cW as ae,dk as oe,d9 as re,e6 as ue,e7 as ne,dx as le,dy as de}from"./vendor.bd18f1cd.js";import{F as M,B as ie,u as N,v as _,A as ce,w as pe,b,I as h,M as me,m as E,L as ve,x as fe,y as we,G as _e}from"./ant-design-vue.b127929a.js";import"./main.e6e69340.js";import"./lodash.5864dd39.js";import"./node-forge.a6b0f3f3.js";import"./echarts.a540ba97.js";import"./prettier.da792cf3.js";const ye="user",ge=i=>H(`${ye}/changePassword`,i),Fe=[{key:"page",icon:L,name:"\u9875\u9762\u7BA1\u7406"},{key:"masterplate",icon:Y,name:"\u6A21\u677F\u7BA1\u7406"}];const ke={class:"header-right"},Ce={class:"exit-dropdown"},Pe={class:"header-right_span"},Be=w("\u4FEE\u6539\u5BC6\u7801"),be=w(" \u8FD4\u56DE\u7BA1\u7406\u9875 "),he=w("\u9000\u51FA"),Ee=S({setup(i){const v=A.get($.USER_INFO),l=v?J.parse(v):{},y=Q(),n=ee(),g=z(),r=C(!1),j=x("locale"),R=x("switchLocale"),u=U({password:"",newPassword:"",confirmPassword:""}),F=async(c,s)=>/S+/.test(s)?Promise.reject("\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A\u3002"):/^[a-zA-Z]\w{5,17}$/.test(s)?Promise.resolve():Promise.reject("\u5BC6\u7801\u9700\u4EE5\u5B57\u6BCD\u5F00\u5934\uFF0C\u957F\u5EA6\u57286~18\u4E4B\u95F4\u3002"),K=U({password:[{required:!0,validator:F,trigger:"blur"}],newPassword:[{required:!0,validator:F,trigger:"blur"}],confirmPassword:[{required:!0,validator:async(c,s)=>{const[o]=await D(F(c,s));return o?Promise.reject(o):s!==u.newPassword?Promise.reject("\u4E24\u6B21\u8F93\u5165\u4E0D\u4E00\u81F4\u3002"):Promise.resolve()},trigger:"blur"}]}),{resetFields:T,validate:q,validateInfos:k}=M.useForm(u,K),Z=async()=>{const[c]=await D(q());if(c)return;const s=I(u.password),o=I(u.newPassword),f=await ge({password:s,newPassword:o});f.code===0?(r.value=!1,E.success("\u4FEE\u6539\u6210\u529F\uFF01")):E.error(f.msg)},G=()=>{A.remove($.AUTHORIZATION),y.push(`/login?redirect=${n.path}`),E.success("\u5DF2\u9000\u51FA\u767B\u5F55\uFF01")};return(c,s)=>(d(),O(V,null,[p("div",ke,[t(e(ie),{onClick:s[0]||(s[0]=o=>{var f;return(f=e(R))==null?void 0:f()})},{default:a(()=>[w(P(e(j)),1)]),_:1}),t(e(pe),null,{overlay:a(()=>[t(e(N),null,{default:a(()=>[t(e(_),{key:"0",onClick:s[1]||(s[1]=o=>r.value=!0)},{default:a(()=>[Be]),_:1}),c.$route.path.includes("editor")?(d(),m(e(_),{key:"1",onClick:s[2]||(s[2]=o=>c.$router.push("/"))},{default:a(()=>[be]),_:1})):se("",!0),t(e(_),{key:"2",onClick:G},{default:a(()=>[he]),_:1})]),_:1})]),default:a(()=>[p("div",Ce,[t(e(ce),null,{icon:a(()=>[t(e(L))]),_:1}),p("span",Pe,P(e(l).name),1)])]),_:1}),t(e(te),{class:"theme-change",onClick:s[3]||(s[3]=o=>e(g).switchTheme())})]),t(e(me),{visible:r.value,"onUpdate:visible":s[7]||(s[7]=o=>r.value=o),title:"\u4FEE\u6539\u5BC6\u7801","after-close":e(T),onOk:Z},{default:a(()=>[t(e(M),{model:e(u),"label-col":{span:4},"wrapper-col":{span:16}},{default:a(()=>[t(e(b),B({label:"\u539F\u5BC6\u7801"},e(k).password),{default:a(()=>[t(e(h),{value:e(u).password,"onUpdate:value":s[4]||(s[4]=o=>e(u).password=o),type:"password"},null,8,["value"])]),_:1},16),t(e(b),B({label:"\u65B0\u5BC6\u7801"},e(k).newPassword),{default:a(()=>[t(e(h),{value:e(u).newPassword,"onUpdate:value":s[5]||(s[5]=o=>e(u).newPassword=o),type:"password"},null,8,["value"])]),_:1},16),t(e(b),B({label:"\u786E\u8BA4\u5BC6\u7801"},e(k).confirmPassword),{default:a(()=>[t(e(h),{value:e(u).confirmPassword,"onUpdate:value":s[6]||(s[6]=o=>e(u).confirmPassword=o),type:"password"},null,8,["value"])]),_:1},16)]),_:1},8,["model"])]),_:1},8,["visible","after-close"])],64))}});const je=i=>(le("data-v-027eec89"),i=i(),de(),i),Ae=je(()=>p("div",{class:"logo"},[p("img",{width:"40",height:"40",src:X})],-1)),$e={class:"main"},Ie=S({setup(i){const v=C(["page"]),l=C(!1);return(y,n)=>{const g=ae("RouterView");return d(),m(e(ve),{class:"container"},{default:a(()=>[t(e(fe),{collapsed:l.value,"onUpdate:collapsed":n[1]||(n[1]=r=>l.value=r),trigger:null,collapsible:""},{default:a(()=>[Ae,t(e(N),{selectedKeys:v.value,"onUpdate:selectedKeys":n[0]||(n[0]=r=>v.value=r),theme:"dark",mode:"inline"},{default:a(()=>[(d(!0),O(V,null,oe(e(Fe),r=>(d(),m(e(_),{key:r.key,onClick:j=>y.$router.push({name:r.key})},{default:a(()=>[(d(),m(re(r.icon))),p("span",null,P(r.name),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["selectedKeys"])]),_:1},8,["collapsed"]),p("div",$e,[t(e(we),{class:"layout-header"},{default:a(()=>[l.value?(d(),m(e(ue),{key:0,class:"trigger",onClick:n[2]||(n[2]=r=>l.value=!l.value)})):(d(),m(e(ne),{key:1,class:"trigger",onClick:n[3]||(n[3]=r=>l.value=!l.value)})),t(Ee)]),_:1}),t(e(_e),{class:"layout-content"},{default:a(()=>[t(g)]),_:1})])]),_:1})}}});var Te=W(Ie,[["__scopeId","data-v-027eec89"]]);export{Te as default};
